import numpy as np 
import pyautogui as auto 
import keyboard 
import os 
from pynput.mouse import Button, Controller 
from vidgear.gears import ScreenGear 
import utils 
import time 
def main(): 
    stream = ScreenGear().start() 
    def endProgram(): 
        keyboard.unhook_all_hotkeys() 
        print('Ending program in between') 
        os._exit(0) 
    keyboard.add_hotkey('Esc+q', endProgram,suppress=True) 
    mouse = Controller() 
    auto.moveTo( x=2458.34765625, y=15.984375000000004,duration=1.0) 
    auto.sleep(1.0) 
    x,y = utils.searchAppNameForNSeconds("python3","b'AUTOMATOR'",[974.0, 510.0, 1586.0, 932.0],2458.34765625,15.984375000000004,5) 
    auto.moveTo( x=x, y=y,duration=5) 
    x,y = utils.searchImageFromScreenshotForNSeconds(stream,"saved_snips_for_cliks/0.png",x=x, y=y, N=2) 
    auto.mouseDown(button='left', x=x, y=y, duration = 2) 
    auto.moveTo( x=2458.34765625, y=15.984375000000004,duration=1.1309990882873535) 
    x,y = utils.searchAppNameForNSeconds("python3","b'AUTOMATOR'",[974.0, 510.0, 1586.0, 932.0],2458.34765625,15.984375000000004,5) 
    auto.moveTo( x=x, y=y,duration=5) 
    x,y = utils.searchImageFromScreenshotForNSeconds(stream,"saved_snips_for_cliks/1.png",x=x, y=y, N=2) 
    auto.mouseUp(button='left', x=x, y=y, duration = 0.13099908828735352) 
    keyboard.press("d") 
    auto.sleep(1.0) 
    keyboard.release("d") 
    auto.sleep(1.0) 
    keyboard.press("i") 
    auto.sleep(1.0) 
    keyboard.release("i") 
    auto.sleep(1.0) 
    keyboard.press("c") 
    auto.sleep(1.0) 
    keyboard.release("c") 
    auto.sleep(1.0) 
    keyboard.press("t") 
    auto.sleep(1.0) 
    keyboard.release("t") 
    auto.sleep(1.0) 
    keyboard.press("i") 
    auto.sleep(1.0) 
    keyboard.release("i") 
    auto.sleep(1.0) 
    keyboard.press("o") 
    auto.sleep(1.0) 
    keyboard.press("n") 
    auto.sleep(1.0) 
    keyboard.release("o") 
    auto.sleep(1.0) 
    keyboard.release("n") 
    auto.sleep(1.0) 
    keyboard.press("a") 
    auto.sleep(1.0) 
    keyboard.press("r") 
    auto.sleep(1.0) 
    keyboard.release("a") 
    auto.sleep(1.0) 
    keyboard.release("r") 
    auto.sleep(1.0) 
    keyboard.press("y") 
    auto.sleep(1.0) 
    keyboard.release("y") 
    auto.sleep(1.0) 
    keyboard.press("enter") 
    auto.sleep(1.0) 
    keyboard.release("enter") 
    auto.sleep(1.0) 
    auto.moveTo( x=140.0078125, y=850.1640625,duration=5.464261531829834) 
    x,y = utils.searchAppNameForNSeconds("Dictionary","b'Dictionary'",[76.0, 780.0, 476.0, 1160.0],140.0078125,850.1640625,5) 
    auto.moveTo( x=x, y=y,duration=5) 
    x,y = utils.searchImageFromScreenshotForNSeconds(stream,"saved_snips_for_cliks/24.png",x=x, y=y, N=2) 
    auto.mouseDown(button='left', x=x, y=y, duration = 4.464261531829834) 
    auto.moveTo( x=139.7890625, y=850.1640625,duration=1.0121681690216064) 
    auto.moveTo( x=139.7890625, y=850.1640625,duration=0.01) 
    x,y = utils.searchAppNameForNSeconds("Dictionary","b'Dictionary'",[76.0, 780.0, 476.0, 1160.0],139.7890625,850.1640625,5) 
    auto.moveTo( x=x, y=y,duration=5) 
    x,y = utils.searchImageFromScreenshotForNSeconds(stream,"saved_snips_for_cliks/26.png",x=x, y=y, N=2) 
    auto.mouseUp(button='left', x=x, y=y, duration = 0.25430750846862793) 
    auto.moveTo( x=227.72265625, y=852.26171875,duration=2.173250913619995) 
    x,y = utils.searchAppNameForNSeconds("Dictionary","b'Dictionary'",[76.0, 780.0, 476.0, 1160.0],227.72265625,852.26171875,5) 
    auto.moveTo( x=x, y=y,duration=5) 
    x,y = utils.searchImageFromScreenshotForNSeconds(stream,"saved_snips_for_cliks/27.png",x=x, y=y, N=2) 
    auto.mouseDown(button='left', x=x, y=y, duration = 1.1732509136199951) 
    auto.moveTo( x=227.72265625, y=852.26171875,duration=1.2009999752044678) 
    x,y = utils.searchAppNameForNSeconds("Dictionary","b'Dictionary'",[76.0, 780.0, 476.0, 1160.0],227.72265625,852.26171875,5) 
    auto.moveTo( x=x, y=y,duration=5) 
    x,y = utils.searchImageFromScreenshotForNSeconds(stream,"saved_snips_for_cliks/28.png",x=x, y=y, N=2) 
    auto.mouseUp(button='left', x=x, y=y, duration = 0.20099997520446777) 
    auto.moveTo( x=289.2890625, y=852.26171875,duration=2.080659866333008) 
    x,y = utils.searchAppNameForNSeconds("Dictionary","b'Dictionary'",[76.0, 780.0, 476.0, 1160.0],289.2890625,852.26171875,5) 
    auto.moveTo( x=x, y=y,duration=5) 
    x,y = utils.searchImageFromScreenshotForNSeconds(stream,"saved_snips_for_cliks/29.png",x=x, y=y, N=2) 
    auto.mouseDown(button='left', x=x, y=y, duration = 1.0806598663330078) 
    auto.moveTo( x=289.0390625, y=852.26171875,duration=1.0148110389709473) 
    auto.moveTo( x=289.0390625, y=852.26171875,duration=0.01) 
    x,y = utils.searchAppNameForNSeconds("Dictionary","b'Dictionary'",[76.0, 780.0, 476.0, 1160.0],289.0390625,852.26171875,5) 
    auto.moveTo( x=x, y=y,duration=5) 
    x,y = utils.searchImageFromScreenshotForNSeconds(stream,"saved_snips_for_cliks/31.png",x=x, y=y, N=2) 
    auto.mouseUp(button='left', x=x, y=y, duration = 0.3584122657775879) 
    keyboard.press("esc") 
    auto.sleep(1.0) 
    keyboard.press("esc") 
    auto.sleep(1.0) 
    keyboard.press("esc") 
    auto.sleep(1.0) 
    stream.stop() 
    utils.speakText("Task completed sucessfully") 
if __name__ == '__main__': 
    main() 
